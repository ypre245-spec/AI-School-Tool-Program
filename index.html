<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI School Tool Program | DepEd Aligned</title>
    
    <!-- Favicon -->
    <link rel="icon" href="https://ui-avatars.com/api/?name=AI+School&background=1e3a8a&color=fff&rounded=true" type="image/png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        holiday: ['Inter', 'sans-serif'], // Remapped to Inter for standard theme
                    },
                    colors: {
                        deped: {
                            blue: '#1e3a8a', // Dark Blue
                            red: '#dc2626',  // Red
                            yellow: '#facc15', // Yellow
                            light: '#f8fafc',
                            dark: '#0f172a',
                        },
                        // Remapped 'ny' palette to DepEd Theme colors
                        ny: { 
                            gold: '#facc15', // Yellow accent
                            goldlight: '#ffffff', // White text for headers
                            midnight: '#1e3a8a', // DepEd Blue primary
                            silver: '#e2e8f0',
                            accent: '#dc2626' // Red accent
                        },
                        wellness: {
                            dark: '#0f172a',
                            purple: '#312e81',
                            text: '#e2e8f0'
                        }
                    },
                    boxShadow: {
                        'glow': '0 0 20px rgba(30, 58, 138, 0.2)', // Blue Glow
                        'card-hover': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'breathe': 'breathe 4s ease-in-out infinite',
                        'spin-slow': 'spin 8s linear infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        },
                        breathe: {
                            '0%, 100%': { opacity: '0.6', transform: 'scale(1)' },
                            '50%': { opacity: '1', transform: 'scale(1.05)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        .glass-nav {
            background: rgba(30, 58, 138, 0.95); /* DepEd Blue */
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 3px solid #facc15; /* Yellow border strip */
        }
        
        .hero-pattern {
            background-color: #f8fafc;
            /* Blue and Red dots */
            background-image: radial-gradient(#1e3a8a 0.5px, transparent 0.5px), radial-gradient(#dc2626 0.5px, #f8fafc 0.5px);
            background-size: 24px 24px;
            background-position: 0 0, 12px 12px;
            opacity: 0.1;
        }
        
        .chat-pattern {
            background-color: #f8fafc;
            background-image: radial-gradient(rgba(30, 58, 138, 0.05) 1px, transparent 1px), radial-gradient(rgba(220, 38, 38, 0.05) 1px, #f8fafc 1px);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
        }

        /* Wellness Mode Styles (Adapted for Standard Theme) */
        body.wellness-active {
            /* Standard Background */
            background-color: #f8fafc; 
            color: #1e293b;
            overflow-x: hidden;
        }
        
        body.wellness-active .productivity-zone {
            display: none !important;
        }
        
        body.wellness-active .wellness-zone {
            display: flex !important;
            animation: fadeIn 1s ease-in;
        }

        /* Keep Navigation Standard even in Maintenance */
        body.wellness-active .glass-nav {
            background: rgba(30, 58, 138, 0.95);
            border-bottom: 3px solid #facc15;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Scroll Animation Classes */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s cubic-bezier(0.5, 0, 0, 1);
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        .hidden-tool {
            display: none !important;
        }

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f5f9; 
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 10px;
            border: 2px solid #f1f5f9;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        
        .text-glow {
            text-shadow: 0 0 20px rgba(30, 58, 138, 0.2);
        }
        
        /* Date Badge Style */
        .date-badge {
            font-size: 10px;
            color: #64748b; /* slate-500 */
            background-color: #e2e8f0; /* slate-200 */
            padding: 4px 12px;
            border-radius: 9999px;
            margin: 16px auto 8px auto; /* Centered with vertical spacing */
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            width: fit-content;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 antialiased flex flex-col min-h-screen font-sans selection:bg-deped-blue selection:text-white transition-colors duration-700">

    <!-- Preloader -->
    <div id="initial-loader" class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center transition-opacity duration-700">
        <div class="relative">
             <i class="fa-solid fa-circle-notch fa-spin text-5xl text-deped-blue/20"></i>
             <div class="absolute inset-0 flex items-center justify-center">
                 <img src="https://ui-avatars.com/api/?name=AI&background=transparent&color=1e3a8a&bold=true" class="w-6 h-6 animate-pulse">
             </div>
        </div>
        <p class="mt-4 text-deped-blue text-sm font-bold tracking-widest uppercase animate-pulse">Loading System Resources...</p>
    </div>

    <!-- Notification Modal (Hidden by Default) -->
    <div id="announcement-modal" class="fixed inset-0 z-[150] bg-black/80 hidden flex items-center justify-center p-4 backdrop-blur-sm transition-opacity duration-300 opacity-0">
        <div class="bg-white rounded-2xl max-w-md w-full p-6 shadow-2xl border-t-4 border-deped-red relative transform scale-95 transition-transform duration-300 max-h-[80vh] overflow-y-auto custom-scroll">
            <button id="close-announcement" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 transition"><i class="fa-solid fa-xmark text-xl"></i></button>
            <div class="text-center">
                 <div class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-4 text-deped-blue text-3xl shadow-md border border-blue-100">
                     <i class="fa-solid fa-bullhorn"></i>
                 </div>
                 <h3 id="announcement-title" class="text-xl font-bold text-slate-800 mb-3">Announcement</h3>
                 <p id="announcement-message" class="text-slate-600 leading-relaxed text-sm bg-slate-50 p-4 rounded-xl border border-slate-100"></p>
                 <button id="ack-announcement" class="mt-6 w-full bg-deped-blue hover:bg-blue-800 text-white font-bold py-3 rounded-xl transition shadow-lg text-sm uppercase tracking-wide">
                     Okay, Got it
                 </button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="glass-nav text-white shadow-lg sticky top-0 z-50 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center">
                <!-- Logo / Brand -->
                <a href="#" class="flex items-center space-x-3 group">
                    <div class="relative transform group-hover:scale-105 transition duration-300">
                        <img src="https://ui-avatars.com/api/?name=AI+School&background=ffffff&color=1e3a8a&size=128&rounded=true&bold=true" 
                             alt="AI School Tool Logo" 
                             class="h-10 w-10 rounded-full shadow-lg ring-2 ring-white/50">
                    </div>
                    <div>
                        <h1 class="font-bold text-xl md:text-2xl leading-tight tracking-wide text-white">AI School Tool</h1>
                        <p id="nav-subtitle" class="text-[10px] text-deped-blue font-bold tracking-widest uppercase bg-yellow-400 px-2 py-0.5 rounded-full inline-block">Official Beta</p>
                    </div>
                </a>

                <!-- Desktop Menu -->
                <div class="hidden md:flex space-x-1 items-center">
                    <!-- Wellness Mode Only Links -->
                    <div class="wellness-zone hidden items-center gap-4 text-sm font-medium text-white/90">
                        <span id="wellness-status" class="bg-blue-800/50 px-3 py-1 rounded-full border border-blue-400/30"><i class="fa-solid fa-screwdriver-wrench mr-2 text-yellow-300"></i>Maintenance Mode Active</span>
                    </div>

                    <!-- Productivity Links (Hidden in Wellness Mode) -->
                    <div class="productivity-zone flex space-x-1 items-center">
                        <a href="#home" class="px-4 py-2 rounded-full hover:bg-white/10 transition font-medium text-sm">Home</a>
                        <a href="#tools" class="px-4 py-2 rounded-full hover:bg-white/10 transition font-medium text-sm">AI Tools</a>
                        <a href="#about" class="px-4 py-2 rounded-full hover:bg-white/10 transition font-medium text-sm">Mission</a>
                    </div>
                    
                    <a href="#community" class="ml-4 bg-white text-deped-blue px-6 py-2.5 rounded-full font-bold transition shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 text-sm flex items-center border border-slate-200">
                        <i class="fa-solid fa-users mr-2"></i> Community Hub
                    </a>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden flex items-center">
                    <button id="mobile-menu-btn" class="text-white p-2 rounded-lg hover:bg-white/10 focus:outline-none transition">
                        <i class="fa-solid fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu Panel -->
        <div id="mobile-menu" class="hidden md:hidden bg-deped-blue border-t border-slate-700 absolute w-full shadow-2xl">
            <div class="px-4 pt-4 pb-6 space-y-2">
                <div class="productivity-zone">
                    <a href="#home" class="block px-4 py-3 rounded-lg hover:bg-blue-800 transition font-medium">Home</a>
                    <a href="#tools" class="block px-4 py-3 rounded-lg hover:bg-blue-800 transition font-medium">AI Tools</a>
                    <a href="#about" class="block px-4 py-3 rounded-lg hover:bg-blue-800 transition font-medium">Mission</a>
                </div>
                <a href="#community" class="block px-4 py-3 rounded-lg bg-white text-deped-blue hover:bg-slate-100 mt-4 text-center font-bold shadow-md">Community Hub</a>
            </div>
        </div>
    </nav>

    <!-- WRAPPER: PRODUCTIVITY ZONE -->
    <div class="productivity-zone">
        <!-- Hero Section -->
        <section id="home" class="relative pt-24 pb-28 overflow-hidden bg-white">
            <div class="absolute inset-0 hero-pattern z-0"></div>
            
            <!-- Decorative Elements -->
            <div class="absolute top-0 right-0 -mr-40 -mt-20 w-[600px] h-[600px] rounded-full bg-gradient-to-br from-blue-50 to-transparent opacity-50 blur-3xl z-0"></div>
            <div class="absolute bottom-0 left-0 -ml-20 -mb-20 w-96 h-96 rounded-full bg-gradient-to-tr from-red-50 to-transparent opacity-50 blur-3xl z-0"></div>

            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center reveal">
                <span class="inline-flex items-center px-4 py-1.5 rounded-full bg-blue-50 border border-blue-100 shadow-sm text-deped-blue text-xs font-bold tracking-widest uppercase mb-8 hover:scale-105 transition cursor-default">
                    <i class="fa-solid fa-flag mr-2 text-deped-red"></i> Mabuhay, Teachers!
                </span>
                <h1 class="text-5xl md:text-7xl lg:text-8xl font-bold text-slate-900 tracking-tight mb-8 leading-none drop-shadow-sm">
                    Empowering<br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-deped-blue via-blue-600 to-deped-red pb-2">Filipino Teachers</span>
                </h1>
                <p class="mt-4 max-w-2xl mx-auto text-xl text-slate-600 leading-relaxed font-light">
                    Streamline your workflow with curriculum-aligned AI tools designed for the modern classroom. Efficient, accessible, and ready for 2026.
                </p>
                <div class="mt-12 flex flex-col sm:flex-row justify-center gap-4">
                    <a href="#tools" class="group px-8 py-4 bg-deped-blue text-white rounded-xl font-bold shadow-lg hover:shadow-blue-900/30 transition-all transform hover:-translate-y-1 flex items-center justify-center gap-3 relative overflow-hidden border border-blue-700">
                        <div class="absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700"></div>
                        <i class="fa-solid fa-paper-plane text-xl"></i> Launch Tools
                    </a>
                    <a href="#about" class="px-8 py-4 bg-white text-slate-600 border border-slate-200 rounded-xl font-semibold shadow-sm hover:bg-slate-50 hover:border-slate-300 transition-all flex items-center justify-center gap-2">
                        <i class="fa-solid fa-circle-info text-slate-400"></i> Learn More
                    </a>
                </div>
                
                <!-- Trust Indicators -->
                <div class="mt-12 pt-8 border-t border-slate-100 max-w-lg mx-auto flex justify-center items-center gap-6 text-slate-500 text-sm font-medium">
                    <span class="flex items-center gap-2"><i class="fa-solid fa-check-circle text-deped-blue"></i> Free to Use</span>
                    <span class="flex items-center gap-2"><i class="fa-solid fa-check-circle text-deped-blue"></i> DepEd Aligned</span>
                    <span class="flex items-center gap-2"><i class="fa-solid fa-check-circle text-deped-blue"></i> Mobile Ready</span>
                </div>
            </div>
        </section>

        <!-- Voices Section (Spotlight) -->
        <section class="py-16 bg-slate-50 border-y border-slate-200 relative z-20">
            <div class="max-w-4xl mx-auto px-4 relative reveal">
                <!-- Floating Decoration -->
                <div class="absolute -top-10 -left-10 text-8xl text-blue-100 transform -rotate-12 hidden lg:block select-none pointer-events-none">"</div>
                
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-bold text-slate-800">Voices of Our Teachers</h2>
                    <div class="flex justify-center mt-3 space-x-2">
                         <span class="w-1.5 h-1.5 rounded-full bg-deped-blue"></span>
                         <span class="w-8 h-1.5 rounded-full bg-deped-red"></span>
                         <span class="w-1.5 h-1.5 rounded-full bg-deped-yellow"></span>
                    </div>
                </div>

                <!-- Spotlight Card -->
                <div class="relative max-w-3xl mx-auto">
                    <div class="absolute inset-0 bg-white rounded-3xl shadow-sm transform translate-y-2 translate-x-2 border border-slate-200"></div>
                    <div class="bg-white rounded-3xl p-8 md:p-12 shadow-xl border border-slate-100 relative overflow-hidden">
                        <!-- Card Decoration -->
                        <div class="absolute top-0 right-0 w-32 h-32 bg-blue-50 rounded-bl-full opacity-50 -mr-10 -mt-10"></div>
                        
                        <div class="text-center relative z-10">
                            <i class="fa-solid fa-quote-left text-4xl text-blue-200 mb-6 block mx-auto"></i>
                            <!-- CHANGED: min-h-[140px] -> h-[350px] to fix layout shifting -->
                            <div id="spotlight-content" class="h-[350px] flex flex-col justify-center items-center transition-opacity duration-500 opacity-100">
                                <p class="text-xl md:text-2xl text-slate-700 font-medium italic mb-6 leading-relaxed">"Loading inspiring stories..."</p>
                            </div>
                        </div>
                        
                        <!-- Indicators -->
                        <div id="spotlight-indicators" class="flex justify-center gap-2 mt-2"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tools Section -->
        <section id="tools" class="bg-white py-24 relative">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12 reveal">
                    <span class="text-deped-red font-bold text-sm tracking-widest uppercase mb-2 block">Powered by Gemini</span>
                    <h2 class="text-4xl md:text-5xl font-bold text-slate-900 mb-6">Tools for Education</h2>
                    <p class="mt-4 text-slate-600 max-w-2xl mx-auto text-lg">
                        Select a tool below to launch the AI assistant. Designed to support your daily teaching tasks.
                    </p>
                </div>

                <div id="tools-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 min-h-[400px]">
                    <!-- Loading Skeleton -->
                    <div class="col-span-full flex flex-col items-center justify-center text-slate-400 py-12">
                        <i class="fa-solid fa-circle-notch fa-spin text-3xl mb-4 text-deped-blue"></i>
                        <p class="text-sm font-medium animate-pulse">Fetching latest tools from cloud database...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="bg-slate-50 py-24 relative overflow-hidden">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                <div class="lg:grid lg:grid-cols-2 lg:gap-20 items-center">
                    <div class="mb-12 lg:mb-0 relative reveal">
                        <!-- Image/Illustration Area -->
                        <div class="relative bg-white rounded-3xl p-10 border-2 border-slate-200 shadow-sm">
                            <i class="fa-solid fa-calendar-check text-blue-100 text-9xl absolute bottom-0 right-0 -mr-4 -mb-4 opacity-50"></i>
                            <h3 class="text-2xl font-bold text-slate-900 mb-6 text-3xl">Why AI in Education?</h3>
                            <ul class="space-y-6">
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mt-1 mr-4">
                                        <i class="fa-solid fa-check text-blue-600 text-sm"></i>
                                    </div>
                                    <span class="text-slate-700 font-medium leading-snug">Efficient lesson planning and grading support.</span>
                                </li>
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mt-1 mr-4">
                                        <i class="fa-solid fa-check text-blue-600 text-sm"></i>
                                    </div>
                                    <span class="text-slate-700 font-medium leading-snug">Reduce administrative workload for teachers.</span>
                                </li>
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mt-1 mr-4">
                                        <i class="fa-solid fa-check text-blue-600 text-sm"></i>
                                    </div>
                                    <span class="text-slate-700 font-medium leading-snug">Create engaging, contextualized learning materials.</span>
                                </li>
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mt-1 mr-4">
                                        <i class="fa-solid fa-check text-blue-600 text-sm"></i>
                                    </div>
                                    <span class="text-slate-700 font-medium leading-snug">Foster innovation in the Filipino classroom.</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="reveal">
                        <span class="text-deped-blue font-bold tracking-widest uppercase text-sm mb-2 block">Our Mission</span>
                        <h2 class="text-4xl md:text-5xl font-bold text-slate-900 mb-6">"Para sa Bata,<br>Para sa Bayan."</h2>
                        <p class="text-slate-600 leading-relaxed mb-6 text-lg">
                            The AI School Tool Program aims to be the helping hand every teacher deserves. We believe that Artificial Intelligence should not replace teachers, but rather act as a supportive partner that amplifies their capacity to inspire.
                        </p>
                        <p class="text-slate-600 leading-relaxed text-lg">
                            By providing accessible and curriculum-aligned tools, we hope to give you back the precious gift of time for your family and yourself.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Call to Action -->
        <section class="bg-deped-blue py-20 relative overflow-hidden reveal">
            <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
            <div class="max-w-4xl mx-auto px-4 text-center relative z-10">
                <h2 class="text-4xl md:text-5xl font-bold text-white mb-6">Ready to Innovate?</h2>
                <p class="text-blue-100 mb-10 text-xl font-light">Join thousands of Filipino educators utilizing modern tools today.</p>
                <a href="#tools" class="inline-block bg-white text-deped-blue font-bold py-4 px-10 rounded-full shadow-2xl hover:bg-yellow-400 hover:text-blue-900 transition transform hover:scale-105">
                    <i class="fa-solid fa-rocket mr-2"></i> Start Planning Now
                </a>
            </div>
        </section>
    </div>

    <!-- WRAPPER: WELLNESS ZONE (Updated for Light Theme) -->
    <div class="wellness-zone hidden flex-col items-center justify-center pt-32 pb-12 px-4 text-center relative overflow-hidden">
        
        <!-- Background Decoration (Light) -->
        <div class="absolute inset-0 z-0 opacity-10">
             <div class="absolute top-20 left-10 w-64 h-64 bg-deped-blue rounded-full filter blur-3xl"></div>
             <div class="absolute bottom-20 right-10 w-64 h-64 bg-deped-red rounded-full filter blur-3xl"></div>
        </div>

        <!-- Floating Elements (Tech Themed - Colors Adjusted) -->
        <div class="absolute top-20 left-10 text-6xl opacity-10 animate-float text-deped-blue" style="animation-delay: 1s;">
            <i class="fa-solid fa-cloud-arrow-up"></i>
        </div>
        <div class="absolute top-40 right-10 text-4xl opacity-10 animate-float text-deped-blue" style="animation-delay: 2s;">
            <i class="fa-solid fa-code"></i>
        </div>
        <div class="absolute bottom-20 left-20 text-5xl opacity-10 animate-float text-deped-blue" style="animation-delay: 0.5s;">
            <i class="fa-solid fa-rocket"></i>
        </div>

        <!-- Main Upgrading Animation -->
        <div class="mb-8 relative z-10">
            <i class="fa-solid fa-gear text-8xl text-deped-blue/10 absolute -top-4 -right-4 animate-[spin_8s_linear_infinite]"></i>
            <i class="fa-solid fa-gear text-6xl text-yellow-400 drop-shadow-md animate-[spin_4s_linear_infinite_reverse]"></i>
            <i class="fa-solid fa-wrench text-3xl text-slate-400 absolute bottom-0 -left-2 animate-bounce"></i>
        </div>
        
        <h2 id="maintenance-title" class="text-4xl md:text-6xl font-bold text-slate-800 mb-4 tracking-wide relative z-10">System Maintenance Underway</h2>
        <p id="maintenance-message" class="text-lg md:text-xl text-slate-600 max-w-2xl mx-auto font-light leading-relaxed relative z-10">
            We are currently performing scheduled upgrades to enhance platform performance and reliability.<br>
            Thank you for your patience as we prepare a better experience for you.
        </p>

        <!-- Upgrading Capabilities List (Light Theme Cards) -->
        <div class="mt-8 relative z-10">
            <p class="text-slate-500 text-[10px] uppercase tracking-widest mb-4 font-semibold">Optimizing Core Systems:</p>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 max-w-4xl mx-auto text-left">
                
                <!-- Tool 1 -->
                <div class="p-3 bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition">
                    <div class="flex items-center gap-2 mb-1">
                        <i class="fa-solid fa-book-open text-deped-blue"></i>
                        <h4 class="text-slate-800 font-bold text-xs uppercase">K-12 Lesson Planner</h4>
                    </div>
                    <p class="text-[10px] text-slate-500 leading-tight">Comprehensive daily lesson log builder for all grade levels.</p>
                </div>

                <!-- Tool 2 -->
                <div class="p-3 bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition">
                    <div class="flex items-center gap-2 mb-1">
                        <i class="fa-solid fa-shield-halved text-deped-red"></i>
                        <h4 class="text-slate-800 font-bold text-xs uppercase">MATATAG Planner</h4>
                    </div>
                    <p class="text-[10px] text-slate-500 leading-tight">Aligned with the new MATATAG curriculum standards.</p>
                </div>

                <!-- Tool 3 -->
                <div class="p-3 bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition">
                    <div class="flex items-center gap-2 mb-1">
                        <i class="fa-solid fa-book-journal-whills text-yellow-500"></i>
                        <h4 class="text-slate-800 font-bold text-xs uppercase">Story Generator</h4>
                    </div>
                    <p class="text-[10px] text-slate-500 leading-tight">Create engaging, contextualized stories for young learners.</p>
                </div>

                <!-- Tool 4 -->
                <div class="p-3 bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition">
                    <div class="flex items-center gap-2 mb-1">
                        <i class="fa-solid fa-table-list text-emerald-600"></i>
                        <h4 class="text-slate-800 font-bold text-xs uppercase">TOS Generator</h4>
                    </div>
                    <p class="text-[10px] text-slate-500 leading-tight">Automated Table of Specifications for valid assessments.</p>
                </div>

                <!-- Tool 5 -->
                <div class="p-3 bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition">
                    <div class="flex items-center gap-2 mb-1">
                        <i class="fa-solid fa-chalkboard-user text-purple-600"></i>
                        <h4 class="text-slate-800 font-bold text-xs uppercase">Presentation Maker</h4>
                    </div>
                    <p class="text-[10px] text-slate-500 leading-tight">Instant slide outlines and educational content generation.</p>
                </div>

                <!-- Tool 6 -->
                <div class="p-3 bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition">
                    <div class="flex items-center gap-2 mb-1">
                        <i class="fa-solid fa-user-tie text-blue-600"></i>
                        <h4 class="text-slate-800 font-bold text-xs uppercase">PMES with COI</h4>
                    </div>
                    <p class="text-[10px] text-slate-500 leading-tight">Teacher performance assessment with PPST-based classroom observation indicators.</p>
                </div>

            </div>
        </div>

        <div class="mt-8 px-6 py-2 bg-slate-100 rounded-full border border-slate-200 inline-block relative z-10">
            <span class="text-slate-500 text-xs uppercase tracking-widest font-bold" id="wellness-hours-text">Scheduled Maintenance</span>
        </div>

        <!-- NEW: Countdown Timer -->
        <div id="countdown-container" class="mt-8 relative z-10">
            <p class="text-slate-400 text-[10px] uppercase tracking-[0.2em] mb-3 font-semibold">Estimated Completion In</p>
            <div id="wellness-countdown" class="text-3xl md:text-5xl font-mono font-bold text-deped-blue tracking-widest tabular-nums">
                --d --h --m --s
            </div>
        </div>
        
        <div class="mt-12 w-full max-w-md border-t border-slate-200 pt-8 relative z-10">
            <p class="text-slate-500 text-sm mb-4">You can still chat with fellow teachers while you wait:</p>
            <i class="fa-solid fa-arrow-down text-deped-blue animate-bounce"></i>
        </div>
    </div>

    <!-- Unified Community Hub Section (Always Visible) -->
    <section id="community" class="py-24 relative border-y border-slate-200 bg-slate-50 transition-colors duration-700">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold transition-colors duration-700 mb-4 font-sans section-title text-slate-800">Teacher Community Hub</h2>
                <div class="h-1.5 w-24 bg-deped-blue mx-auto rounded-full"></div>
                <p class="mt-4 transition-colors duration-700 section-desc text-slate-600">See what others are saying and share your own story!</p>
            </div>

            <!-- Modern Unified Chat Interface -->
            <div class="reveal max-w-2xl mx-auto">
                <div class="bg-white rounded-[2rem] shadow-xl border border-slate-200 h-[650px] flex flex-col relative overflow-hidden ring-8 ring-slate-100 transition-all duration-700" id="chat-container">
                    
                    <!-- App Header -->
                    <div class="bg-white/95 backdrop-blur-md p-4 border-b border-slate-200 flex items-center justify-between sticky top-0 z-20">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-full bg-blue-100 text-deped-blue flex items-center justify-center shadow-sm">
                                <i class="fa-solid fa-heart"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-slate-800 text-sm">Community Wall</h3>
                                <div class="flex items-center gap-1.5">
                                    <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                                    <p class="text-[10px] text-slate-500 uppercase tracking-wider font-bold">Live Feed</p>
                                </div>
                            </div>
                        </div>
                        <div class="flex gap-2">
                             <button class="w-8 h-8 rounded-full bg-slate-100 hover:bg-slate-200 flex items-center justify-center text-slate-400 transition"><i class="fa-solid fa-ellipsis"></i></button>
                        </div>
                    </div>

                    <!-- Chat Area -->
                    <div id="stories-grid" class="flex-grow overflow-y-auto p-4 md:p-6 chat-pattern space-y-6 custom-scroll bg-slate-50/50">
                        <div class="text-center py-20 opacity-50">
                            <i class="fa-solid fa-circle-notch fa-spin text-2xl text-deped-blue mb-3"></i>
                            <p class="text-sm text-slate-500 font-medium">Fetching messages...</p>
                        </div>
                    </div>
                    
                    <!-- Load More -->
                    <div class="px-4 py-2 bg-gradient-to-b from-transparent to-white/80">
                        <button id="loadMoreBtn" class="hidden w-full text-center text-xs font-bold text-slate-400 py-2 hover:text-deped-blue transition uppercase tracking-widest">
                            <i class="fa-solid fa-clock-rotate-left mr-1"></i> Load older messages
                        </button>
                    </div>

                    <!-- Input Area -->
                    <div class="bg-white p-4 z-20 shadow-[0_-10px_40px_-10px_rgba(0,0,0,0.05)] relative border-t border-slate-100">
                         <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>
                         
                         <form id="contactForm" 
                              action="https://docs.google.com/forms/d/e/1FAIpQLSeX6DQW6JTdMVN_lmBqe-m4izcFGiTyhPf2uYqQ5GgVmpf37Q/formResponse" 
                              method="POST" 
                              target="hidden_iframe"
                              class="relative">
                             
                             <!-- Error Message -->
                             <div id="errorMessage" class="hidden absolute -top-10 left-0 right-0 mx-auto w-fit bg-red-100 text-red-600 px-3 py-1 rounded-full text-xs font-bold shadow-sm animate-bounce text-center">
                                <i class="fa-solid fa-circle-exclamation mr-1"></i> Please keep messages friendly!
                             </div>

                             <!-- Input Container -->
                             <div class="bg-slate-50 p-1.5 rounded-[1.5rem] border border-slate-200 focus-within:ring-2 focus-within:ring-blue-100 focus-within:border-blue-300 transition-all shadow-inner">
                                 <div class="flex flex-col px-2 pt-2">
                                     <!-- Name -->
                                     <div class="flex items-center gap-2 border-b border-slate-200 pb-2 mb-2">
                                        <div class="w-6 h-6 rounded-full bg-slate-200 flex items-center justify-center"><i class="fa-solid fa-user text-[10px] text-slate-500"></i></div>
                                        <input type="text" id="name" name="entry.385038069" required 
                                            class="text-xs font-bold text-slate-700 bg-transparent outline-none placeholder-slate-400 w-full" 
                                            placeholder="Your Name">
                                     </div>
                                     <!-- Message Row -->
                                     <div class="flex items-end gap-2">
                                         <div class="relative w-full">
                                             <textarea id="message" name="entry.1499916649" rows="1" required maxlength="300"
                                                 class="text-sm text-slate-700 bg-transparent outline-none resize-none placeholder-slate-400 w-full mb-1 max-h-24 pb-4" 
                                                 placeholder="Share your message..."
                                                 oninput="this.style.height = ''; this.style.height = Math.min(this.scrollHeight, 100) + 'px'; document.getElementById('char-count').innerText = this.value.length + '/300';"></textarea>
                                             <div id="char-count" class="absolute bottom-1 right-0 text-[10px] text-slate-400 font-mono pointer-events-none">0/300</div>
                                         </div>
                                         
                                         <button type="submit" id="sendBtn" class="w-10 h-10 rounded-full bg-deped-blue text-white flex-shrink-0 flex items-center justify-center shadow-md hover:bg-blue-700 transition transform active:scale-95 mb-1">
                                             <i class="fa-solid fa-paper-plane text-xs"></i>
                                         </button>
                                     </div>
                                 </div>
                             </div>
                         </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-slate-900 text-slate-300 py-20 border-t border-slate-800 relative overflow-hidden">
        <!-- Decorative Background Glow -->
        <div class="absolute top-0 left-1/2 -translate-x-1/2 w-full max-w-3xl h-full bg-blue-900/20 blur-[100px] rounded-full pointer-events-none"></div>
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-blue-900 to-transparent opacity-30"></div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12 lg:gap-16 mb-16 items-start">
                
                <!-- Column 1: Brand & Mission -->
                <div class="space-y-6">
                    <div class="flex items-center space-x-3">
                        <div class="relative group">
                            <div class="absolute inset-0 bg-blue-500 blur rounded-full opacity-20 group-hover:opacity-40 transition duration-500"></div>
                            <img src="https://ui-avatars.com/api/?name=AI+School&background=1e3a8a&color=fff&size=64&rounded=true&bold=true" 
                                 alt="AI School Tool Logo" 
                                 class="h-12 w-12 rounded-full border-2 border-slate-700 relative z-10">
                        </div>
                        <div>
                            <h4 class="text-white font-bold text-lg leading-tight">AI School Tool</h4>
                            <p class="text-[10px] text-blue-400 uppercase tracking-widest font-bold">Official Release</p>
                        </div>
                    </div>
                    <p class="text-sm text-slate-400 leading-relaxed max-w-xs">
                        An independent, non-profit initiative dedicated to empowering Filipino teachers with accessible, cutting-edge technology. 
                    </p>
                    <div class="flex space-x-3 pt-2">
                        <a href="https://www.facebook.com/y2k2009/" class="w-9 h-9 rounded-lg bg-slate-800 border border-slate-700 flex items-center justify-center text-slate-400 hover:bg-blue-600 hover:text-white hover:border-blue-500 transition-all duration-300 group">
                            <i class="fa-brands fa-facebook-f transform group-hover:scale-110 transition"></i>
                        </a>
                        <a href="#" class="w-9 h-9 rounded-lg bg-slate-800 border border-slate-700 flex items-center justify-center text-slate-400 hover:bg-sky-500 hover:text-white hover:border-sky-400 transition-all duration-300 group">
                            <i class="fa-brands fa-twitter transform group-hover:scale-110 transition"></i>
                        </a>
                        <a href="#" class="w-9 h-9 rounded-lg bg-slate-800 border border-slate-700 flex items-center justify-center text-slate-400 hover:bg-pink-600 hover:text-white hover:border-pink-500 transition-all duration-300 group">
                            <i class="fa-brands fa-instagram transform group-hover:scale-110 transition"></i>
                        </a>
                    </div>
                </div>
                
                <!-- Column 2: Navigation -->
                <div class="md:pl-8">
                    <h4 class="text-blue-400 text-xs font-bold uppercase tracking-widest mb-6 flex items-center gap-2">
                        <span class="w-8 h-[1px] bg-blue-500/50"></span> Navigate
                    </h4>
                    
                    <ul class="space-y-3">
                        <li>
                            <a href="#home" class="group flex items-center text-sm text-slate-400 hover:text-white transition-colors duration-300">
                                <span class="w-1.5 h-1.5 rounded-full bg-slate-700 mr-3 group-hover:bg-blue-500 transition-colors"></span>
                                Home
                            </a>
                        </li>
                        <li>
                            <a href="#tools" class="group flex items-center text-sm text-slate-400 hover:text-white transition-colors duration-300">
                                <span class="w-1.5 h-1.5 rounded-full bg-slate-700 mr-3 group-hover:bg-blue-500 transition-colors"></span>
                                AI Tools
                            </a>
                        </li>
                        <li>
                            <a href="#about" class="group flex items-center text-sm text-slate-400 hover:text-white transition-colors duration-300">
                                <span class="w-1.5 h-1.5 rounded-full bg-slate-700 mr-3 group-hover:bg-blue-500 transition-colors"></span>
                                Our Mission
                            </a>
                        </li>
                        <li>
                            <a href="#community" class="group flex items-center text-sm text-slate-400 hover:text-white transition-colors duration-300">
                                <span class="w-1.5 h-1.5 rounded-full bg-slate-700 mr-3 group-hover:bg-blue-500 transition-colors"></span>
                                Community Hub
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Column 3: Support Card -->
                <div>
                    <h4 class="text-blue-400 text-xs font-bold uppercase tracking-widest mb-6 flex items-center gap-2">
                        <span class="w-8 h-[1px] bg-blue-500/50"></span> Developer Support
                    </h4>
                    
                    <div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-1 border border-slate-700/50 shadow-lg group hover:border-blue-500/30 transition-colors duration-500">
                        <div class="bg-slate-900/80 rounded-xl p-5 backdrop-blur-sm relative overflow-hidden">
                            <!-- Background Sparkle -->
                            <div class="absolute -top-10 -right-10 w-20 h-20 bg-blue-500/10 rounded-full blur-xl group-hover:bg-blue-500/20 transition duration-500"></div>

                            <h5 class="text-white font-bold mb-2 flex items-center gap-2">
                                <i class="fa-solid fa-mug-hot text-yellow-500"></i> Buy me a coffee?
                            </h5>
                            <p class="text-xs text-slate-400 mb-4 leading-relaxed">
                                Helps keep the servers running and the tools free for everyone.
                            </p>
                            
                            <button id="support-toggle" class="w-full bg-slate-800 hover:bg-slate-700 text-slate-300 text-xs font-bold py-2.5 px-4 rounded-lg border border-slate-700 transition-all flex items-center justify-between group-hover:text-white">
                                <span>View GCash QR</span>
                                <i id="support-icon" class="fa-solid fa-chevron-down text-[10px]"></i>
                            </button>

                            <!-- Hidden Content -->
                            <div id="support-content" class="hidden mt-3 pt-3 border-t border-slate-800/50 transition-all duration-300">
                                <div class="relative rounded-lg overflow-hidden border border-slate-700 bg-white">
                                    <img src="gcash.jpg" 
                                         id="support-img"
                                         onerror="this.onerror=null; this.src='https://placehold.co/400x400/1e293b/fbbf24?text=GCash+QR';" 
                                         alt="Support via GCash" 
                                         class="w-full h-auto opacity-90 hover:opacity-100 hover:scale-105 transition duration-500 cursor-zoom-in">
                                </div>
                                <p class="text-[10px] text-center text-slate-500 mt-2">Click QR to enlarge</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Bottom Bar -->
            <div class="border-t border-slate-800/50 pt-8 flex flex-col items-center justify-center text-center relative z-10">
                <p class="text-slate-500 text-sm mb-6">&copy; 2026 AI School Tool Program. All rights reserved.</p>
                
                <div class="group relative inline-flex items-center gap-2 px-6 py-3 bg-slate-900/80 rounded-full border border-slate-700/50 hover:border-blue-500/40 transition-all duration-500 shadow-lg hover:shadow-blue-500/10 hover:-translate-y-1 cursor-default">
                    <!-- Glow effect behind -->
                    <div class="absolute inset-0 bg-gradient-to-r from-transparent via-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition duration-700 rounded-full"></div>
                    
                    <span class="text-xs text-slate-400 font-medium relative z-10">Created by</span>
                    
                    <span class="relative z-10 font-bold tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-blue-200 to-blue-400 animate-pulse group-hover:animate-none transition-all duration-300">
                        DAVID JESS F. ASAURO
                    </span>
                    
                    <!-- Small sparkle icon -->
                    <i class="fa-solid fa-code text-blue-500 text-[10px] opacity-0 group-hover:opacity-100 -translate-x-2 group-hover:translate-x-0 transition-all duration-300"></i>
                </div>
            </div>
        </div>
    </footer>

    <!-- Full Screen Image Modal -->
    <div id="image-modal" class="fixed inset-0 z-[200] bg-black/95 hidden flex items-center justify-center p-4 cursor-zoom-out transition-opacity duration-300 opacity-0 backdrop-blur-sm">
        <img id="modal-img" src="" alt="Full Screen Support" class="max-w-full max-h-[90vh] rounded-lg shadow-2xl transform scale-95 transition-transform duration-300 border-2 border-yellow-500">
        <p class="absolute bottom-10 text-white/50 text-sm animate-pulse">Click anywhere to close</p>
    </div>

    <!-- Logic Script -->
    <script>
        // 1. Mobile Menu Toggle
        const btn = document.getElementById('mobile-menu-btn');
        const menu = document.getElementById('mobile-menu');

        if(btn && menu){
            btn.addEventListener('click', () => {
                menu.classList.toggle('hidden');
            });
            const mobileLinks = menu.querySelectorAll('a');
            mobileLinks.forEach(link => {
                link.addEventListener('click', () => {
                    menu.classList.add('hidden');
                });
            });
        }

        // 2. Scroll Animation (Entrance Effects)
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, observerOptions);

        const revealElements = document.querySelectorAll('.reveal');
        revealElements.forEach(el => observer.observe(el));

        // 3. Contact Form Handler (Slow Mode + Profanity + Optimistic UI)
        const COOLDOWN_MS = 5 * 60 * 1000; // 5 Minutes
        const STORAGE_KEY = 'ai_school_cooldown_target_v2'; 
        
        const foulWords = [
            "bobo", "tanga", "gago", "ulol", "tarantado", "putangina", "pukingina", "tangina", "kupal", "kantot",
            "pota", "ina mo", "hayop", "gaga", "pakyu", "burat", "etits", "pepe", "kepiyas", "jakol", "hindot", 
            "pucha", "leche", "gagi", "buwisit", "bwisit", "hayuf", "demonyo", "lintik", "ungas", "abnoy", 
            "baliw", "sira ulo", "inutil", "ogag", "pakshet", "tite", "bilat",
            "shit", "fuck", "damn", "bitch", "asshole", "stupid", "idiot", "kiss my ass", "ass", "fucker",
            "bullshit", "crap", "bastard", "dick", "cock", "pussy", "vagina", "penis", "sex", "porn", "xxx", 
            "nigger", "nigga", "slut", "whore", "cunt", "arse", "motherfucker", "son of a bitch", "retard"
        ];

        function hasFoulLanguage(text) {
            return foulWords.some(word => {
                const regex = new RegExp(`\\b${word}\\b`, 'gi');
                return regex.test(text);
            });
        }

        function startTimer(btn, targetTimestamp) {
            btn.disabled = true;
            btn.classList.add('bg-slate-400', 'cursor-not-allowed');
            btn.classList.remove('bg-deped-blue', 'hover:bg-blue-700', 'active:scale-95');
            
            if (btn.dataset.timerId) clearInterval(parseInt(btn.dataset.timerId));

            const updateDisplay = () => {
                const now = Date.now();
                const remaining = targetTimestamp - now;

                if (remaining <= 0) {
                    clearInterval(parseInt(btn.dataset.timerId));
                    btn.disabled = false;
                    btn.innerHTML = '<i class="fa-solid fa-paper-plane text-xs"></i>';
                    btn.classList.remove('bg-slate-400', 'cursor-not-allowed');
                    btn.classList.add('bg-deped-blue', 'hover:bg-blue-700', 'active:scale-95');
                    localStorage.removeItem(STORAGE_KEY);
                } else {
                    const minutes = Math.floor((remaining / 1000) / 60);
                    const seconds = Math.floor((remaining / 1000) % 60);
                    btn.innerHTML = `<span class="text-[10px] font-bold font-mono">${minutes}:${seconds.toString().padStart(2, '0')}</span>`;
                }
            };

            updateDisplay(); 
            const interval = setInterval(updateDisplay, 1000);
            btn.dataset.timerId = interval; 
        }

        function checkCooldown(btn) {
            const storedTarget = localStorage.getItem(STORAGE_KEY);
            if (!storedTarget) return;

            const targetTime = parseInt(storedTarget);
            const now = Date.now();
            
            if (targetTime > now) {
                startTimer(btn, targetTime);
            } else {
                localStorage.removeItem(STORAGE_KEY);
            }
        }

        // 5. FETCH STORIES FROM GOOGLE SHEETS
        let allStories = [];
        let storiesDisplayed = 0;
        let currentSpotlightIndex = 0;
        let spotlightInterval;
        
        // --- GLOBAL CONFIG VARS ---
        let scheduledWellness = null; 
        let maintenanceText = null;
        let globalNotification = null;

        let countdownInterval = null; 
        const BATCH_SIZE = 10; 
        
        // --- DATA HASHING FOR AUTO-REFRESH ---
        let lastStoriesHash = "";
        let lastToolsHash = "";

        // Helper to parse Gviz Date or Strings
        function parseGvizDate(val) {
             if (!val) return null;
             
             // 1. Gviz Date Object: "Date(2025, 11, 25, 8, 0, 0)"
             if (typeof val === 'string' && val.startsWith('Date(')) {
                 const nums = val.match(/\d+/g);
                 if (nums && nums.length >= 6) {
                     // Month is 0-indexed in JS Date
                     return new Date(nums[0], nums[1], nums[2], nums[3], nums[4], nums[5]);
                 }
             }
             
             // 2. Standard String: "2025-12-25 08:00" or similar
             const tryDate = new Date(val);
             if (!isNaN(tryDate.getTime())) {
                 return tryDate;
             }
             
             return null;
        }

        async function fetchStories() {
            const sheetId = '1p69v6YNSjn8n7IrW9h0Qk9get61eh-ONYNxaMz76RFA';
            const gid = '1355823203';
            const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&tq&gid=${gid}`;

            try {
                const response = await fetch(url);
                const text = await response.text();
                
                const jsonMatch = text.match(/google\.visualization\.Query\.setResponse\(([\s\S]*)\);/);
                if (!jsonMatch || !jsonMatch[1]) throw new Error('Invalid GVIZ response');
                
                const json = JSON.parse(jsonMatch[1]);
                const rows = json.table.rows;

                // SMART CHECK: Only proceed if data changed
                const currentHash = JSON.stringify(rows);
                if (currentHash === lastStoriesHash) return; 
                lastStoriesHash = currentHash;

                if(rows && rows.length > 0) {
                    // Parse data safely
                    allStories = rows.map(row => {
                        if (!row.c) return null;
                        
                        // NOTE: Maintenance Logic moved to Sheet1 (fetchTools) as per request

                        const nameCell = row.c[1];
                        const name = (nameCell && nameCell.v) ? String(nameCell.v) : 'Anonymous';

                        let timestamp = "Recently";
                        let dateGroup = "Unknown Date";
                        
                        // Date Parsing (Column A -> Index 0)
                        const dateCell = row.c[0];
                        if (dateCell) {
                             let dateObj = parseGvizDate(dateCell.v);
                             if(!dateObj && dateCell.f) dateObj = parseGvizDate(dateCell.f); 

                             if (dateObj) {
                                 timestamp = dateObj.toLocaleTimeString([], {hour: 'numeric', minute:'2-digit'});
                                 const today = new Date();
                                 const yesterday = new Date(today);
                                 yesterday.setDate(yesterday.getDate() - 1);
                                 if (dateObj.toDateString() === today.toDateString()) {
                                     dateGroup = "Today";
                                 } else if (dateObj.toDateString() === yesterday.toDateString()) {
                                     dateGroup = "Yesterday";
                                 } else {
                                     dateGroup = dateObj.toLocaleDateString([], {month: 'long', day: 'numeric', year: 'numeric'});
                                 }
                             }
                        }

                        // Message Finding Logic (Cols 2,3,4,5)
                        let candidates = [];
                        [2, 3, 4, 5].forEach(i => {
                            const cell = row.c[i];
                            if (cell && cell.v) {
                                const txt = String(cell.v);
                                const isDateLike = txt.startsWith('Date(') || !isNaN(Date.parse(txt)) && txt.length < 20; 
                                if (!txt.includes('@') && !txt.includes('google.com') && !isDateLike && txt.length > 1) {
                                    candidates.push(txt);
                                }
                            }
                        });

                        if (candidates.length === 0) return null;
                        candidates.sort((a, b) => b.length - a.length);
                        const message = candidates[0];

                        return { name, message, timestamp, dateGroup };
                    }).filter(story => story !== null);
                    
                    initSpotlight([...allStories].reverse().slice(0, 5));

                    const grid = document.getElementById('stories-grid');
                    
                    // Only maintain scroll if we are not at the very top (loading history)
                    // For auto-refresh, we usually want to snap to bottom if new messages appear
                    // or keep position. For simplicity in this "Live Feed", we rebuild.
                    const wasAtBottom = grid.scrollHeight - grid.scrollTop === grid.clientHeight;
                    
                    grid.innerHTML = ''; 
                    
                    storiesDisplayed = BATCH_SIZE; 
                    const initialBatch = allStories.slice(Math.max(allStories.length - BATCH_SIZE, 0));
                    
                    let lastGroup = null;
                    initialBatch.forEach(story => {
                        if (story.dateGroup !== lastGroup) {
                            grid.appendChild(createDateBadge(story.dateGroup));
                            lastGroup = story.dateGroup;
                        }
                        grid.appendChild(createChatBubble(story));
                    });
                    
                    // Auto-scroll to bottom on fresh load or update
                    setTimeout(() => grid.scrollTop = grid.scrollHeight, 100);

                    const loadMoreBtn = document.getElementById('loadMoreBtn');
                    if (allStories.length > BATCH_SIZE) {
                        loadMoreBtn.classList.remove('hidden');
                    }

                } else {
                     document.getElementById('stories-grid').innerHTML = '<p class="text-center py-10 text-slate-400 text-xs">No stories yet. Be the first to share!</p>';
                }

            } catch (err) {
                console.log('Error', err);
                const grid = document.getElementById('stories-grid');
                if(grid.innerHTML.trim() === "") grid.innerHTML = getStaticStoriesHTML(); 
            }
        }

        // NEW: Fetch Tools + Config from Sheet1
        async function fetchTools() {
            const sheetId = '1p69v6YNSjn8n7IrW9h0Qk9get61eh-ONYNxaMz76RFA';
            const sheetName = 'Sheet1';
            const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

            try {
                const res = await fetch(url);
                const text = await res.text();
                const jsonText = text.substring(text.indexOf("(") + 1, text.lastIndexOf(")"));
                const json = JSON.parse(jsonText);
                
                const rows = json.table.rows;

                // SMART CHECK: Only update if data changed
                const currentHash = JSON.stringify(rows);
                if (currentHash === lastToolsHash) return;
                lastToolsHash = currentHash;

                const container = document.getElementById('tools-container');
                container.innerHTML = ''; // Clear loader

                if (!rows || rows.length === 0) {
                    container.innerHTML = '<div class="col-span-full text-center text-slate-500 py-10"><i class="fa-solid fa-folder-open text-4xl mb-3 opacity-30"></i><p>No tools available right now.</p></div>';
                    return;
                }

                // Reset Configs
                scheduledWellness = null;
                globalNotification = null;
                maintenanceText = null;

                // Palette for dynamic cards (DepEd Theme Colors)
                const styles = [
                    { border: 'border-l-4 border-l-blue-600', text: 'text-blue-700', bgIcon: 'bg-blue-50', iconColor: 'text-blue-600', stripColor: 'bg-blue-600' },
                    { border: 'border-l-4 border-l-red-600', text: 'text-red-700', bgIcon: 'bg-red-50', iconColor: 'text-red-600', stripColor: 'bg-red-600' },
                    { border: 'border-l-4 border-l-yellow-500', text: 'text-yellow-700', bgIcon: 'bg-yellow-50', iconColor: 'text-yellow-600', stripColor: 'bg-yellow-500' },
                    { border: 'border-l-4 border-l-emerald-600', text: 'text-emerald-700', bgIcon: 'bg-emerald-50', iconColor: 'text-emerald-600', stripColor: 'bg-emerald-600' },
                ];

                rows.forEach((row, index) => {
                    // --- 1. TOOL DATA (Cols A, B, C) ---
                    const name = row.c[0] ? row.c[0].v : null;
                    const link = row.c[1] ? row.c[1].v : "#";
                    const details = row.c[2] ? row.c[2].v : "No details provided.";
                    
                    if(name) {
                        const style = styles[index % styles.length];
                        const categories = "planning content assessment prof-dev"; 

                        const cardHTML = `
                        <a href="${link}" target="_blank" class="tool-card group relative block h-full reveal active bg-white rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 border border-slate-200 overflow-hidden hover:-translate-y-1">
                            <div class="p-6 flex flex-col h-full">
                                <div class="flex justify-between items-start mb-4">
                                    <div class="w-12 h-12 ${style.bgIcon} rounded-lg flex items-center justify-center ${style.iconColor} text-xl transition-transform group-hover:scale-110">
                                        <i class="fa-solid fa-wand-magic-sparkles"></i>
                                    </div>
                                    <span class="px-2 py-1 bg-slate-100 text-slate-500 text-[10px] font-bold uppercase tracking-wider rounded">New</span>
                                </div>
                                
                                <h3 class="text-lg font-bold text-slate-900 mb-2 group-hover:text-deped-blue transition-colors">${name}</h3>
                                
                                <p class="text-slate-500 text-sm leading-relaxed mb-6 flex-grow">
                                    ${details}
                                </p>
                                
                                <div class="mt-auto pt-4 border-t border-slate-50">
                                    <div class="flex items-center text-xs font-bold uppercase tracking-widest ${style.text}">
                                        Open Tool <i class="fa-solid fa-arrow-right ml-2 transition-transform group-hover:translate-x-1"></i>
                                    </div>
                                </div>
                            </div>
                            <!-- Bottom Color Strip -->
                            <div class="h-1 w-full ${style.stripColor}"></div> 
                        </a>
                        `;
                        container.insertAdjacentHTML('beforeend', cardHTML);
                    }

                    // --- 2. NOTIFICATIONS (Cols D, E) ---
                    // D: Detail/Title, E: Message
                    if (row.c[3]?.v && row.c[4]?.v) {
                        globalNotification = {
                            title: String(row.c[3].v),
                            message: String(row.c[4].v)
                        };
                    }

                    // --- 3. MAINTENANCE CONFIG (Cols F, G, H, I) ---
                    // F: Start, G: End, H: Details(Title), I: Message(Body)
                    if (row.c[5] && row.c[6]) {
                        const start = parseGvizDate(row.c[5].v);
                        const end = parseGvizDate(row.c[6].v);
                        if(start && end) {
                            scheduledWellness = { start, end };
                            // Check for custom Text
                            if(row.c[7]?.v || row.c[8]?.v) {
                                maintenanceText = {
                                    title: row.c[7]?.v || "System Maintenance Underway",
                                    message: row.c[8]?.v || "We are currently performing scheduled upgrades."
                                };
                            }
                        }
                    }
                });
                
                // After processing all rows, check configurations
                checkWellnessTime();
                showNotification();

            } catch (err) {
                console.error('Error fetching tools:', err);
                if (document.getElementById('tools-container').innerHTML.trim() === "") {
                    document.getElementById('tools-container').innerHTML = `
                        <div class="col-span-full text-center text-red-400 py-10">
                            <i class="fa-solid fa-triangle-exclamation text-3xl mb-2"></i>
                            <p class="text-sm">Unable to load tools. Please refresh.</p>
                        </div>`;
                }
            } finally {
                // HIDE LOADER
                const loader = document.getElementById('initial-loader');
                if(loader) {
                    loader.classList.add('opacity-0');
                    setTimeout(() => loader.remove(), 700);
                }
            }
        }

        function showNotification() {
            if(!globalNotification) return;

            const modal = document.getElementById('announcement-modal');
            const titleEl = document.getElementById('announcement-title');
            const msgEl = document.getElementById('announcement-message');
            const closeBtn = document.getElementById('close-announcement');
            const ackBtn = document.getElementById('ack-announcement');

            if(modal && titleEl && msgEl) {
                // IMPROVED CHECK: Use Title + Message as unique ID
                // This ensures if you change ONLY the title, it still reappears.
                const notificationId = globalNotification.title + "||" + globalNotification.message;
                const lastSeenId = localStorage.getItem('last_seen_announcement_id');
                
                // Fallback for older version compatibility (check message content only if ID not present)
                if (!lastSeenId && localStorage.getItem('last_seen_announcement') === globalNotification.message) return;
                
                if (lastSeenId === notificationId) return;

                titleEl.innerText = globalNotification.title;
                msgEl.innerText = globalNotification.message;
                
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    modal.firstElementChild.classList.remove('scale-95');
                    modal.firstElementChild.classList.add('scale-100');
                }, 100);

                const closeModal = () => {
                    modal.classList.add('opacity-0');
                    modal.firstElementChild.classList.remove('scale-100');
                    modal.firstElementChild.classList.add('scale-95');
                    setTimeout(() => {
                        modal.classList.add('hidden');
                        // Save the new unique ID
                        localStorage.setItem('last_seen_announcement_id', notificationId);
                        // Clean up old key if exists
                        localStorage.removeItem('last_seen_announcement');
                    }, 300);
                };

                closeBtn.onclick = closeModal;
                ackBtn.onclick = closeModal;
            }
        }

        function loadMoreStories() {
            const grid = document.getElementById('stories-grid');
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            
            const currentCount = document.querySelectorAll('.group.reveal').length;
            const remaining = allStories.length - currentCount;
            
            if (remaining <= 0) return;

            const nextBatchSize = Math.min(BATCH_SIZE, remaining);
            const startIndex = allStories.length - currentCount - nextBatchSize;
            const endIndex = allStories.length - currentCount;
            
            const olderBatch = allStories.slice(startIndex, endIndex);
            
            const fragment = document.createDocumentFragment();
            let lastGroupInBatch = null;
            
            olderBatch.forEach((story, index) => {
                if (story.dateGroup !== lastGroupInBatch) {
                    fragment.appendChild(createDateBadge(story.dateGroup));
                    lastGroupInBatch = story.dateGroup;
                }
                fragment.appendChild(createChatBubble(story));
            });

            const firstExistingElement = grid.firstElementChild;
            if (firstExistingElement && firstExistingElement.classList.contains('date-badge')) {
                if (firstExistingElement.innerText === lastGroupInBatch) {
                    grid.removeChild(firstExistingElement);
                }
            }

            grid.insertBefore(fragment, grid.firstChild);
            
            if (startIndex <= 0) {
                loadMoreBtn.innerText = "No older messages";
                loadMoreBtn.disabled = true;
                loadMoreBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        function createDateBadge(text) {
            const div = document.createElement('div');
            div.className = 'date-badge';
            div.innerText = text;
            return div;
        }

        function initSpotlight(stories) {
            if (!stories || stories.length === 0) return;
            const indicatorsContainer = document.getElementById('spotlight-indicators');
            indicatorsContainer.innerHTML = '';
            stories.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = `w-2 h-2 rounded-full transition-all duration-300 ${index === 0 ? 'bg-deped-blue w-6' : 'bg-slate-300'}`;
                dot.id = `spotlight-dot-${index}`;
                indicatorsContainer.appendChild(dot);
            });
            updateSpotlightHTML(stories[0]);
            if (stories.length > 1) {
                if (spotlightInterval) clearInterval(spotlightInterval);
                spotlightInterval = setInterval(() => {
                    currentSpotlightIndex = (currentSpotlightIndex + 1) % stories.length;
                    transitionSpotlight(stories[currentSpotlightIndex], currentSpotlightIndex);
                }, 6000);
            }
        }

        function transitionSpotlight(story, index) {
            const container = document.getElementById('spotlight-content');
            container.classList.remove('opacity-100');
            container.classList.add('opacity-0');
            setTimeout(() => {
                updateSpotlightHTML(story);
                document.querySelectorAll('#spotlight-indicators div').forEach((dot, i) => {
                    if (i === index) {
                        dot.classList.remove('bg-slate-300', 'w-2');
                        dot.classList.add('bg-deped-blue', 'w-6');
                    } else {
                        dot.classList.remove('bg-deped-blue', 'w-6');
                        dot.classList.add('bg-slate-300', 'w-2');
                    }
                });
                container.classList.remove('opacity-0');
                container.classList.add('opacity-100');
            }, 500);
        }

        function updateSpotlightHTML(story) {
            const container = document.getElementById('spotlight-content');
            container.innerHTML = `
                <p class="text-xl md:text-2xl text-slate-700 font-medium italic mb-6 leading-relaxed">"${story.message}"</p>
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-deped-blue to-blue-600 text-white flex items-center justify-center font-bold text-sm shadow-md">${story.name.charAt(0)}</div>
                    <div class="text-left">
                        <p class="text-sm font-bold text-slate-800">${story.name}</p>
                        <p class="text-[10px] text-slate-400 uppercase tracking-wider font-semibold">Verified Teacher</p>
                    </div>
                </div>
            `;
        }

        function createChatBubble(story) {
            const bubble = document.createElement('div');
            bubble.className = 'flex flex-col group reveal active';
            bubble.innerHTML = `
                <div class="flex items-start gap-2 mb-1 ml-1">
                    <div class="w-8 h-8 rounded-full bg-slate-200 flex-shrink-0 flex items-center justify-center text-[10px] font-bold text-slate-500 shadow-sm mt-1">${story.name.charAt(0)}</div>
                    <div class="flex flex-col">
                        <span class="text-xs text-slate-700 font-bold ${document.body.classList.contains('wellness-active') ? 'text-deped-blue' : ''}">${story.name}</span>
                        <span class="text-[10px] text-slate-400">${story.timestamp}</span>
                    </div>
                </div>
                <div class="bg-white chat-bubble-bg border border-slate-100 p-4 rounded-2xl rounded-tl-sm text-sm text-slate-600 shadow-sm max-w-[85%] leading-relaxed">
                    ${story.message}
                </div>
            `;
            return bubble;
        }

        function getStaticStoriesHTML() {
            return `
                <div class="flex flex-col group reveal active">
                    <div class="flex items-start gap-2 mb-1 ml-1">
                        <div class="w-8 h-8 rounded-full bg-slate-200 flex-shrink-0 flex items-center justify-center text-[10px] font-bold text-slate-500 shadow-sm mt-1">T</div>
                        <div class="flex flex-col">
                            <span class="text-xs text-slate-700 font-bold">Teacher Rose</span>
                            <span class="text-[10px] text-slate-400">10:00 AM</span>
                        </div>
                    </div>
                    <div class="bg-white chat-bubble-bg border border-slate-100 p-4 rounded-2xl rounded-tl-sm text-sm text-slate-600 shadow-sm max-w-[85%] leading-relaxed">
                        The Lesson Planner saved me hours this weekend! Now I have more time to prepare for our Christmas party.
                    </div>
                </div>
            `;
        }
        
        // 6. WELLNESS MODE LOGIC (Remote Config Sheet1)
        function toggleWellnessMode(forceState) {
            const body = document.body;
            const subtitle = document.getElementById('nav-subtitle');
            const communityTitle = document.querySelector('.section-title');
            const communityDesc = document.querySelector('.section-desc');
            const chatContainer = document.getElementById('chat-container');
            const statusIndicator = document.getElementById('wellness-status');
            
            // Dynamic Text Elements
            const maintTitle = document.getElementById('maintenance-title');
            const maintMsg = document.getElementById('maintenance-message');

            const isNowWellness = typeof forceState !== 'undefined' ? forceState : !body.classList.contains('wellness-active');

            if (isNowWellness) {
                body.classList.add('wellness-active');
                if(subtitle) subtitle.innerText = "Maintenance Mode ";
                // if(statusIndicator) statusIndicator.innerHTML = '<i class="fa-solid fa-screwdriver-wrench mr-2 text-yellow-300"></i>Maintenance Mode Active';
                
                // Set Custom Text if available
                if(maintenanceText && maintTitle && maintMsg) {
                    maintTitle.innerText = maintenanceText.title;
                    maintMsg.innerText = maintenanceText.message;
                } else {
                    if(maintTitle) maintTitle.innerText = "System Maintenance Underway";
                    if(maintMsg) maintMsg.innerHTML = "We are currently performing scheduled upgrades to enhance platform performance and reliability.<br>Thank you for your patience as we prepare a better experience for you.";
                }

                /* REMOVED DARK MODE OVERRIDES FOR COMMUNITY SECTION
                if(communityTitle) {
                    communityTitle.classList.remove('text-slate-800');
                    communityTitle.classList.add('text-blue-200', 'text-glow');
                }
                if(communityDesc) {
                    communityDesc.classList.remove('text-slate-600');
                    communityDesc.classList.add('text-blue-400');
                }
                if(chatContainer) {
                    chatContainer.classList.remove('bg-white', 'ring-slate-100', 'shadow-xl');
                    chatContainer.classList.add('bg-slate-800/30', 'ring-blue-900/30', 'shadow-[0_0_30px_rgba(30,58,138,0.2)]', 'border-blue-900/50');
                }
                */
            } else {
                body.classList.remove('wellness-active');
                if(subtitle) subtitle.innerText = "Official Beta";
                
                /* RESET STYLES NO LONGER NEEDED AS THEY DON'T CHANGE
                if(communityTitle) {
                    communityTitle.classList.add('text-slate-800');
                    communityTitle.classList.remove('text-blue-200', 'text-glow');
                }
                if(communityDesc) {
                    communityDesc.classList.add('text-slate-600');
                    communityDesc.classList.remove('text-blue-400');
                }
                if(chatContainer) {
                    chatContainer.classList.add('bg-white', 'ring-slate-100', 'shadow-xl');
                    chatContainer.classList.remove('bg-slate-800/30', 'ring-blue-900/30', 'shadow-[0_0_30px_rgba(30,58,138,0.2)]', 'border-blue-900/50');
                }
                */
            }
        }

        function updateCountdown(endTime) {
            const now = new Date();
            const diff = endTime - now;

            if (diff <= 0) {
                // Time is up!
                if (countdownInterval) clearInterval(countdownInterval);
                const timerEl = document.getElementById('wellness-countdown');
                if (timerEl) timerEl.innerText = "00d 00h 00m 00s";
                
                // Exit wellness mode immediately
                toggleWellnessMode(false);
                return;
            }

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            const display = 
                (days < 10 ? "0" + days : days) + "d " +
                (hours < 10 ? "0" + hours : hours) + "h " + 
                (minutes < 10 ? "0" + minutes : minutes) + "m " + 
                (seconds < 10 ? "0" + seconds : seconds) + "s";
            
            const timerEl = document.getElementById('wellness-countdown');
            if (timerEl) timerEl.innerText = display;
        }

        function checkWellnessTime() {
            const now = new Date();
            const timeText = document.getElementById('wellness-hours-text');
            
            // Only Check Remote Schedule from Google Sheet (Col E & F)
            if (scheduledWellness) {
                // Formatting for display
                const startStr = scheduledWellness.start.toLocaleString([], {year: 'numeric', month:'short', day:'numeric', hour: 'numeric', minute:'2-digit'});
                const endStr = scheduledWellness.end.toLocaleString([], {year: 'numeric', month:'short', day:'numeric', hour: 'numeric', minute:'2-digit'});
                
                if (now >= scheduledWellness.start && now <= scheduledWellness.end) {
                    // Force ON
                    if (!document.body.classList.contains('wellness-active')) {
                        toggleWellnessMode(true);
                    }
                    if(timeText) timeText.innerText = `Scheduled Break: ${startStr} - ${endStr}`;

                    // Start Countdown if not running
                    if (!countdownInterval) {
                        updateCountdown(scheduledWellness.end); // Initial update
                        countdownInterval = setInterval(() => {
                            updateCountdown(scheduledWellness.end);
                        }, 1000);
                    }
                    return;
                }
            }

            // Default: Always OFF if no schedule matches
            if (document.body.classList.contains('wellness-active')) {
                toggleWellnessMode(false);
            }
            // Clear interval if we are not in wellness mode
            if (countdownInterval) {
                clearInterval(countdownInterval);
                countdownInterval = null;
            }
        }

        // Initialize (Wait for DOM)
        document.addEventListener('DOMContentLoaded', () => {
             // Safety timeout to remove loader if fetch hangs too long
             setTimeout(() => {
                 const loader = document.getElementById('initial-loader');
                 if(loader && !loader.classList.contains('opacity-0')) {
                     loader.classList.add('opacity-0');
                     setTimeout(() => loader.remove(), 700);
                 }
             }, 5000); // 5s fallback

             fetchStories();
             fetchTools(); // Call new function
             
             // --- AUTO REFRESH LOGIC ---
             // Check for changes every 5 seconds
             setInterval(() => {
                 fetchStories();
                 fetchTools();
             }, 5000);

             // Contact Form Logic
             const contactForm = document.getElementById('contactForm');
             if(contactForm) {
                 const btn = contactForm.querySelector('button[type="submit"]');
                 checkCooldown(btn); // Check on load

                 contactForm.addEventListener('submit', (e) => {
                     // ... (Form submission logic same as before)
                     const messageInput = document.getElementById('message');
                     const nameInput = document.getElementById('name');
                     const errorMessage = document.getElementById('errorMessage');
                     
                     if (hasFoulLanguage(messageInput.value) || hasFoulLanguage(nameInput.value)) {
                         e.preventDefault();
                         errorMessage.classList.remove('hidden');
                         const container = messageInput.closest('.bg-slate-50');
                         if(container) {
                             container.classList.add('ring-2', 'ring-red-300', 'bg-red-50');
                             setTimeout(() => {
                                 container.classList.remove('ring-2', 'ring-red-300', 'bg-red-50');
                                 errorMessage.classList.add('hidden');
                             }, 3000);
                         }
                         return;
                     }

                     const name = nameInput.value;
                     const message = messageInput.value;
                     const targetTime = Date.now() + COOLDOWN_MS;
                     localStorage.setItem(STORAGE_KEY, targetTime);
                     startTimer(btn, targetTime);
                     setTimeout(() => { messageInput.value = ''; }, 100);
                     const dateObj = new Date();
                     const timeString = dateObj.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });
                     const dateGroup = "Today";
                     const newStory = { name: name, message: message, timestamp: timeString, dateGroup: dateGroup };
                     allStories.push(newStory);
                     initSpotlight([...allStories].reverse().slice(0, 5));
                     const grid = document.getElementById('stories-grid');
                     if(grid) {
                         if (grid.children[0] && grid.children[0].classList.contains('text-center')) grid.innerHTML = '';
                         grid.appendChild(createChatBubble(newStory));
                         grid.scrollTop = grid.scrollHeight;
                     }
                 });
             }

             // Load More
             const loadMoreBtn = document.getElementById('loadMoreBtn');
             if(loadMoreBtn) {
                 loadMoreBtn.addEventListener('click', loadMoreStories);
             }

             // Support Section Toggle Logic
             const supportToggle = document.getElementById('support-toggle');
             const supportContent = document.getElementById('support-content');
             const supportIcon = document.getElementById('support-icon');

             if(supportToggle && supportContent && supportIcon) {
                 supportToggle.addEventListener('click', () => {
                     const isHidden = supportContent.classList.contains('hidden');
                     
                     if (isHidden) {
                         supportContent.classList.remove('hidden');
                         // Slight delay to allow display:block to apply before animation could be added if using max-height transition
                         supportIcon.classList.remove('fa-chevron-down');
                         supportIcon.classList.add('fa-chevron-up');
                     } else {
                         supportContent.classList.add('hidden');
                         supportIcon.classList.remove('fa-chevron-up');
                         supportIcon.classList.add('fa-chevron-down');
                     }
                 });
             }

             // Full Screen Image Modal Logic
             const supportImg = document.getElementById('support-img');
             const modal = document.getElementById('image-modal');
             const modalImg = document.getElementById('modal-img');

             if(supportImg && modal && modalImg) {
                 supportImg.addEventListener('click', () => {
                     modal.classList.remove('hidden');
                     // Small delay to allow display:flex to apply before opacity transition
                     setTimeout(() => {
                        modal.classList.remove('opacity-0');
                        modalImg.classList.remove('scale-95');
                        modalImg.classList.add('scale-100');
                     }, 10);
                     modalImg.src = supportImg.src;
                 });

                 modal.addEventListener('click', () => {
                     modal.classList.add('opacity-0');
                     modalImg.classList.remove('scale-100');
                     modalImg.classList.add('scale-95');
                     setTimeout(() => {
                        modal.classList.add('hidden');
                     }, 300);
                 });
             }
        });

        /* --- BASIC SECURITY DETERRENTS --- */
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
        });

        document.addEventListener('keydown', (e) => {
            if(e.key === 'F12' || e.keyCode === 123) {
                e.preventDefault();
                return false;
            }
            if(e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'i' || e.keyCode === 73)) {
                e.preventDefault();
                return false;
            }
            if(e.ctrlKey && e.shiftKey && (e.key === 'C' || e.key === 'c' || e.keyCode === 67)) {
                e.preventDefault();
                return false;
            }
            if(e.ctrlKey && e.shiftKey && (e.key === 'J' || e.key === 'j' || e.keyCode === 74)) {
                e.preventDefault();
                return false;
            }
            if(e.ctrlKey && (e.key === 'U' || e.key === 'u' || e.keyCode === 85)) {
                e.preventDefault();
                return false;
            }
        });
    </script>
</body>
</html>
